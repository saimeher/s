<div id="wrapper">
    <!-- begin TOP NAVIGATION -->
    <app-header></app-header>
    <!-- end TOP NAVIGATION -->

    <!-- begin SIDE NAVIGATION -->
    <app-sidemenu [page]="_apiService.page"></app-sidemenu>
    <!-- end SIDE NAVIGATION -->

    <!-- begin MAIN PAGE CONTENT -->
    <div id="page-wrapper">

        <div class="spl-content">

            <!-- begin PAGE TITLE ROW -->
            <div class="row">
                <div class="col-lg-12">
                    <div class="page-title">
                        <!--<h1>
              Admin <small>Dashboard</small>
            </h1>-->
                        <ol class="breadcrumb">
                            <li><i class="fa fa-dashboard"></i> <a [routerLink]="['/dashboard']">Dashboard</a>
                            </li>
                            <li class="active">Upload Attendance</li>
                            <!--<li class="active">Blank Page</li>-->
                        </ol>
                    </div>
                </div>
                <!-- /.col-lg-12 -->
            </div>
            <!-- /.row -->
            <!-- end PAGE TITLE ROW -->
            <div class="portlet portlet-default">
                <div class="portlet-heading">
                    <div class="portlet-title">
                        <h4>Upload File</h4>
                    </div>
                    <div class="portlet-widgets">
                        <a data-toggle="collapse" data-parent="#accordion" href="#basicFormExample"><i class="fa fa-chevron-down"></i></a>
                    </div>
                    <div class="clearfix"></div>
                </div>
                <div id="basicFormExample" class="panel-collapse collapse in">
                    <div class="portlet-body">
                        <form role="form" #f="ngForm" novalidate>
                            <div class="row">
                                <div class="form-group col-lg-4">
                                    <label>Bio-metric Machine</label>
                                    <select class="form-control" name="machine" #machine="ngModel" [(ngModel)]="model.machine">
                    <option *ngFor="let m of machines" value="{{m.mid}}">{{m.name}}</option>
                  </select>
                                </div>
                                <div class="form-group col-lg-4 hidden">
                                    <label>Select Attendance Date</label>
                                    <my-date-picker [options]="myDatePickerOptions" (dateChanged)="onDateChanged($event)" required></my-date-picker>
                                </div>
                                <div class="form-group col-lg-4" *ngIf="model.machine">
                                    <label for="exampleInputFile">File input</label>
                                    <input type="file" name="att_doc" (click)="startFileUpload()" ngFileSelect [options]="doc_options" (onUpload)="docHandleUpload($event)" (beforeUpload)="beforeUpload($event)">
                                    <p class="help-block">upload .csv file here.</p>
                                </div>
                            </div>
                            <button type="submit" class="btn btn-default hidden">Submit</button>
                        </form>
                    </div>
                </div>
            </div>

            <div class="portlet portlet-green">
                <div class="portlet-heading">
                    <div class="portlet-title">
                        <h4>Upload Files History</h4>
                    </div>
                    <div class="portlet-widgets">
                        <input type="text" class="form-control input-sm" [(ngModel)]="filterQuery">
                    </div>
                    <div class="clearfix"></div>
                </div>
                <div class="portlet-body">
                    <div class="table-responsive">
                        <table class="table table-striped" [mfData]="data | dataFilter : filterQuery" #mf="mfDataTable" [mfRowsOnPage]="20" [(mfSortOrder)]="sortOrder">
                            <thead>
                                <tr>
                                    <th>Upload Time</th>
                                    <th>Upload File</th>
                                    <th>File Date</th>
                                    <th>Bio-metric Machine</th>
                                    <th width="40px"></th>
                                </tr>
                            </thead>
                            <tbody *ngIf="mf.data.length > 0">
                                <tr *ngFor="let ud of mf.data">
                                    <td>{{ud.ttime | date:'yMMMdjms'}}</td>
                                    <td>{{ud.filename}}</td>
                                    <td>{{ud.filedate | date:'mediumDate'}}</td>
                                    <td>{{ud.machine_name}}</td>
                                    <td><a class="btn btn-xs btn-flat btn-danger" (click)="row=ud;deleteUploadFile.open()"><i class="fa fa-trash-o"></i></a></td>
                                </tr>
                            </tbody>
                            <tbody *ngIf="mf.data.length == 0">
                                <tr>
                                    <td colspan="5" align="center">No data found</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

        </div>
        <!-- /.page-content -->

    </div>
    <!-- /#page-wrapper -->
    <!-- end MAIN PAGE CONTENT -->

</div>

<!--popup to view employee personal document  -->
<modal #deleteUploadFile modalClass="modal-flex modal-lg">
    <modal-header>
        <h4 class="modal-title text-uppercase">Are you want to delete this file - <span *ngIf="row">{{row.filename}}</span></h4>
    </modal-header>
    <modal-content>
        <div class="row" *ngIf="row">
            <div class="col-lg-4 well">
                <h3 style="text-align:center">File<br>{{row.filename}}</h3>
            </div>
            <div class="col-lg-4 well">
                <h3 style="text-align:center">Machine<br>{{row.machine_name}}</h3>
            </div>
            <div class="col-lg-4 well">
                <h3 style="text-align:center">Date<br>{{row.filedate | date:'mediumDate'}}</h3>
            </div>
        </div>
        <div class="tile red" *ngIf="deleteError">
            <h4>Error...</h4>
            <br>
            <p>{{deleteErrorMsg}}</p>
        </div>
    </modal-content>
    <modal-footer>
        <button class="btn btn-sm btn-danger" (click)="deleteUploadFile.close();deleteUploadFile()">Yes Delete</button>
        <button class="btn btn-sm btn-primary" (click)="deleteUploadFile.close()">No close</button>
    </modal-footer>
</modal>